<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tally Prime - Payment Voucher</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
body{background:#f0f0f0;color:#333;line-height:1.6;}
.container{max-width:1000px;margin:20px auto;background:#fff;border-radius:5px;box-shadow:0 0 10px rgba(0,0,0,0.1);overflow:hidden;}
.header{background:#2c3e50;color:#fff;padding:15px 20px;display:flex;justify-content:space-between;align-items:center;}
.logo{font-size:24px;font-weight:bold;display:flex;align-items:center;}
.logo span{color:#3498db;}
.voucher-info{display:flex;background:#34495e;padding:10px 20px;color:white;font-size:14px;}
.voucher-info div{margin-right:30px;}
.voucher-form{padding:20px;}
.form-section{margin-bottom:20px;border:1px solid #ddd;border-radius:5px;overflow:hidden;}
.section-header{background:#ecf0f1;padding:10px 15px;font-weight:bold;border-bottom:1px solid #ddd;}
.form-row{display:flex;padding:10px 15px;border-bottom:1px solid #eee;flex-wrap:wrap;}
.form-row:last-child{border-bottom:none;}
.form-group{flex:1;min-width:200px;margin-right:15px;}
.form-group:last-child{margin-right:0;}
label{display:block;margin-bottom:5px;font-weight:500;}
input,select,textarea{width:100%;padding:8px 10px;border:1px solid #ccc;border-radius:4px;font-size:14px;}
input:focus,select:focus,textarea:focus{outline:none;border-color:#3498db;}
.amount-input{font-weight:bold;font-size:16px;}
.buttons{display:flex;justify-content:flex-end;padding:15px;background:#f9f9f9;border-top:1px solid #ddd;}
button{padding:10px 20px;margin-left:10px;border:none;border-radius:4px;cursor:pointer;font-weight:bold;transition:background 0.3s;}
.btn-accept{background:#27ae60;color:white;}.btn-accept:hover{background:#219653;}
.btn-reject{background:#e74c3c;color:white;}.btn-reject:hover{background:#c0392b;}
.btn-alt{background:#3498db;color:white;}.btn-alt:hover{background:#2980b9;}
.transaction-table{width:100%;border-collapse:collapse;margin-top:10px;}
.transaction-table th,.transaction-table td{border:1px solid #ddd;padding:8px;text-align:left;}
.transaction-table th{background:#f2f2f2;}
.add-row{text-align:center;padding:10px;background:#f9f9f9;cursor:pointer;color:#3498db;font-weight:bold;}
.tally-shortcuts{display:flex;background:#2c3e50;padding:5px;color:white;font-size:12px;}
.shortcut{margin-right:15px;}
.success-message{background:#d4edda;color:#155724;padding:10px;border-radius:4px;margin:10px 0;display:none;}
.error-message{background:#f8d7da;color:#721c24;padding:10px;border-radius:4px;margin:10px 0;display:none;}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="logo">Tally<span>Prime</span></div>
        <div>Payment Voucher</div>
    </div>

    <div class="tally-shortcuts">
        <div class="shortcut">F2: Date</div>
        <div class="shortcut">Ctrl+A: Accept</div>
        <div class="shortcut">Ctrl+R: Reject</div>
        <div class="shortcut">Ctrl+E: Edit</div>
        <div class="shortcut">Alt+C: Contra Voucher</div>
        <div class="shortcut">Alt+P: Payment Voucher</div>
        <div class="shortcut">Ctrl+X: Export Excel</div>
    </div>

    <div class="voucher-info">
        <div>Date: <span id="current-date"></span></div>
        <div>Voucher No.: <span id="voucher-number">1</span></div>
        <div>Type: Payment</div>
    </div>

    <div class="success-message" id="success-message"></div>
    <div class="error-message" id="error-message"></div>

    <div class="voucher-form" id="voucher-form">
        <!-- Payment Details -->
        <div class="form-section">
            <div class="section-header">Payment Details</div>
            <div class="form-row">
                <div class="form-group">
                    <label for="payment-date">Date</label>
                    <input type="date" id="payment-date" required>
                </div>
                <div class="form-group">
                    <label for="voucher-no">Voucher No.</label>
                    <input type="text" id="voucher-no" value="1" required>
                </div>
                <div class="form-group">
                    <label for="payment-type">Payment Type</label>
                    <select id="payment-type">
                        <option value="cash">Cash Payment</option>
                        <option value="bank">Bank Payment</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="paid-to">Paid To (Debit)</label>
                    <input type="text" id="paid-to" placeholder="Enter party/account name" required>
                </div>
                <div class="form-group">
                    <label for="paid-from">Paid From (Credit)</label>
                    <input type="text" id="paid-from" placeholder="Cash/Bank account" required>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="amount">Amount (₹)</label>
                    <input type="number" id="amount" class="amount-input" placeholder="0.00" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="payment-mode">Payment Mode</label>
                    <select id="payment-mode">
                        <option value="cash">Cash</option>
                        <option value="cheque">Cheque</option>
                        <option value="neft">NEFT/RTGS</option>
                        <option value="upi">UPI</option>
                        <option value="card">Card</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Transaction Details -->
        <div class="form-section">
            <div class="section-header">Transaction Details</div>
            <table class="transaction-table">
                <thead>
                    <tr>
                        <th>Account</th>
                        <th>Amount (₹)</th>
                        <th>Type</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="transaction-body">
                    <tr>
                        <td><input type="text" class="transaction-account" placeholder="Account name"></td>
                        <td><input type="number" class="transaction-amount" placeholder="0.00" step="0.01"></td>
                        <td>
                            <select class="transaction-type">
                                <option value="debit">Debit</option>
                                <option value="credit">Credit</option>
                            </select>
                        </td>
                        <td><button class="btn-remove-row" onclick="removeRow(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>
            <div class="add-row" onclick="addTransactionRow()">+ Add Row</div>
        </div>

        <!-- Buttons -->
        <div class="form-section">
            <div class="buttons">
                <button type="button" class="btn-accept" onclick="saveVoucher()">Accept (Ctrl+A)</button>
                <button type="button" class="btn-reject" onclick="resetForm()">Reject (Ctrl+R)</button>
                <button type="button" class="btn-alt" onclick="editVoucher()">Edit (Ctrl+E)</button>
                <button type="button" class="btn-alt" onclick="exportExcel()">Export Excel (Ctrl+X)</button>
            </div>
        </div>
    </div>
</div>

<script>
// ====== Date & Voucher No. ======
function setCurrentDate() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('current-date').innerText = today;
    document.getElementById('payment-date').value = today;
}
setCurrentDate();

// Auto Voucher No.
function setVoucherNo() {
    const vouchers = JSON.parse(localStorage.getItem('vouchers') || '[]');
    const nextNo = vouchers.length + 1;
    document.getElementById('voucher-no').value = nextNo;
    document.getElementById('voucher-number').innerText = nextNo;
}
setVoucherNo();

// ====== Transaction Row Functions ======
function addTransactionRow() {
    const tbody = document.getElementById('transaction-body');
    const row = document.createElement('tr');
    row.innerHTML = `
        <td><input type="text" class="transaction-account" placeholder="Account name"></td>
        <td><input type="number" class="transaction-amount" placeholder="0.00" step="0.01"></td>
        <td>
            <select class="transaction-type">
                <option value="debit">Debit</option>
                <option value="credit">Credit</option>
            </select>
        </td>
        <td><button class="btn-remove-row" onclick="removeRow(this)">Remove</button></td>
    `;
    tbody.appendChild(row);
}

function removeRow(btn) {
    const row = btn.closest('tr');
    row.remove();
}

// ====== Save Voucher ======
function saveVoucher() {
    const voucher = {
        date: document.getElementById('payment-date').value,
        voucherNo: document.getElementById('voucher-no').value,
        paymentType: document.getElementById('payment-type').value,
        paidTo: document.getElementById('paid-to').value,
        paidFrom: document.getElementById('paid-from').value,
        amount: document.getElementById('amount').value,
        paymentMode: document.getElementById('payment-mode').value,
        transactions: []
    };

    const accounts = document.querySelectorAll('.transaction-account');
    const amounts = document.querySelectorAll('.transaction-amount');
    const types = document.querySelectorAll('.transaction-type');

    for (let i = 0; i < accounts.length; i++) {
        if (accounts[i].value && amounts[i].value) {
            voucher.transactions.push({
                account: accounts[i].value,
                amount: parseFloat(amounts[i].value),
                type: types[i].value
            });
        }
    }

    // Save in localStorage
    let vouchers = JSON.parse(localStorage.getItem('vouchers') || '[]');
    vouchers.push(voucher);
    localStorage.setItem('vouchers', JSON.stringify(vouchers));

    // Success message
    const msg = document.getElementById('success-message');
    msg.innerText = 'Voucher saved successfully!';
    msg.style.display = 'block';
    setTimeout(() => { msg.style.display = 'none'; }, 3000);

    resetForm();
    setVoucherNo();
}

// ====== Reset Form ======
function resetForm() {
    document.getElementById('voucher-form').reset();
    setCurrentDate();
    document.getElementById('transaction-body').innerHTML = `
        <tr>
            <td><input type="text" class="transaction-account" placeholder="Account name"></td>
            <td><input type="number" class="transaction-amount" placeholder="0.00" step="0.01"></td>
            <td>
                <select class="transaction-type">
                    <option value="debit">Debit</option>
                    <option value="credit">Credit</option>
                </select>
            </td>
            <td><button class="btn-remove-row" onclick="removeRow(this)">Remove</button></td>
        </tr>
    `;
}

// ====== Edit Voucher ======
function editVoucher() {
    alert('Edit feature coming soon!');
}

// ====== Export Excel ======
function exportExcel() {
    const vouchers = JSON.parse(localStorage.getItem('vouchers') || '[]');
    if (vouchers.length === 0) {
        alert('No vouchers to export!');
        return;
    }

    const ws_data = [];
    vouchers.forEach(v => {
        v.transactions.forEach(t => {
            ws_data.push({
                Date: v.date,
                VoucherNo: v.voucherNo,
                PaymentType: v.paymentType,
                PaidTo: v.paidTo,
                PaidFrom: v.paidFrom,
                Amount: v.amount,
                PaymentMode: v.paymentMode,
                Account: t.account,
                TransactionAmount: t.amount,
                Type: t.type
            });
        });
    });

    const ws = XLSX.utils.json_to_sheet(ws_data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Vouchers");
    XLSX.writeFile(wb, "PaymentVouchers.xlsx");
}

// ====== Keyboard Shortcuts ======
document.addEventListener('keydown', (e) => {
    if (e.key === 'F2') document.getElementById('payment-date').focus();
    if (e.ctrlKey && e.key.toLowerCase() === 'a') { e.preventDefault(); saveVoucher(); }
    if (e.ctrlKey && e.key.toLowerCase() === 'r') { e.preventDefault(); resetForm(); }
    if (e.ctrlKey && e.key.toLowerCase() === 'e') { e.preventDefault(); editVoucher(); }
    if (e.ctrlKey && e.key.toLowerCase() === 'x') { e.preventDefault(); exportExcel(); }
});
</script>
</body>
</html>
