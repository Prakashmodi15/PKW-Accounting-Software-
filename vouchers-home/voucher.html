<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vouchers - PKW Accounting</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <style>
    body { font-family: "Segoe UI", Roboto, Arial, sans-serif; background:#fff; color:#0b2440; margin:0; }
    .topbar { background:#2b66ad; color:#fff; padding:12px 16px; font-weight:700; display:flex; align-items:center; }
    .topbar h1 { margin:0; font-size:18px; }
    .container { padding:20px; }
    .voucher-menu { display:flex; flex-wrap:wrap; gap:12px; margin-bottom:20px; }
    .voucher-item { padding:12px 16px; border:1px solid #cbd8e8; border-radius:4px; cursor:pointer; background:#e8f6fb; font-weight:600; }
    .voucher-item:hover { background:#dff0fb; }
    .voucher-item.active { background:#f4b400; color:#000; }
    .voucher-table { width:100%; border-collapse:collapse; }
    .voucher-table th, .voucher-table td { border:1px solid #d0d8e6; padding:8px; text-align:left; }
    .voucher-table th { background:#f1f6fb; }
  </style>
</head>
<body>

  <div class="topbar">
    <h1>Vouchers - PKW Accounting</h1>
  </div>

  <div class="container">
    <div class="voucher-menu">
      <div class="voucher-item active" data-type="payment">Payment Voucher</div>
      <div class="voucher-item" data-type="receipt">Receipt Voucher</div>
      <div class="voucher-item" data-type="contra">Contra Voucher</div>
      <div class="voucher-item" data-type="journal">Journal Voucher</div>
      <div class="voucher-item" data-type="sales">Sales Voucher</div>
      <div class="voucher-item" data-type="purchase">Purchase Voucher</div>
      <div class="voucher-item" data-type="debit-note">Debit Note Voucher</div>
      <div class="voucher-item" data-type="credit-note">Credit Note Voucher</div>
      <div class="voucher-item" data-type="memorandum">Memorandum Voucher</div>
      <div class="voucher-item" data-type="reversing-journal">Reversing Journal Voucher</div>
    </div>

    <table class="voucher-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Account Debit</th>
          <th>Account Credit</th>
          <th>Amount</th>
          <th>Narration</th>
        </tr>
      </thead>
      <tbody id="voucherBody">
        <tr><td colspan="5">Loading...</td></tr>
      </tbody>
    </table>
  </div>

  <script>
    (function(){
      const items = document.querySelectorAll('.voucher-item');
      const tbody = document.getElementById('voucherBody');

      // Function to load vouchers from backend API
      async function loadVouchers(type) {
        tbody.innerHTML = '<tr><td colspan="5">Loading...</td></tr>';
        try {
          const res = await fetch('http://localhost:3000/vouchers/1'); // demo company_id = 1
          const data = await res.json();
          const filtered = data.filter(v => v.type.toLowerCase() === type);
          if(filtered.length === 0){
            tbody.innerHTML = '<tr><td colspan="5">No vouchers found</td></tr>';
          } else {
            tbody.innerHTML = filtered.map(v=>`
              <tr>
                <td>${v.date}</td>
                <td>${v.account_debit}</td>
                <td>${v.account_credit}</td>
                <td>${v.amount}</td>
                <td>${v.narration}</td>
              </tr>
            `).join('');
          }
        } catch(err){
          tbody.innerHTML = '<tr><td colspan="5">Error loading vouchers</td></tr>';
          console.error(err);
        }
      }

      // Menu click
      items.forEach(it=>{
        it.addEventListener('click', ()=>{
          items.forEach(x=>x.classList.remove('active'));
          it.classList.add('active');
          loadVouchers(it.dataset.type);
        });
      });

      // Initial load - Payment Voucher
      loadVouchers('payment');
    })();
  </script>

</body>
</html>
